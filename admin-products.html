<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ“¦ Mahsulotlar â€” Admin Panel</title>
  <link rel="stylesheet" href="admin-style.css">
</head>
<body>

  <header class="admin-header">
    <h1>ğŸ“¦ Mahsulotlar Roâ€˜yxati</h1>
    <p>Barcha mahsulotlar grid koâ€˜rinishida</p>
  </header>

  <main>
    <div class="product-admin-grid" id="productGrid">
      <!-- Mahsulotlar JS orqali yuklanadi -->
    </div>
  </main>

  <footer class="admin-footer">
    <nav>
      <a href="admin.html">ğŸ“Š Statistika</a>
      <a href="admin-add.html">â• Mahsulot Qoâ€˜shish</a>
      <a href="admin-orders.html">ğŸ›’ Buyurtmalar</a>
      <a href="admin-setting.html">âš™ï¸ Sozlamalar</a>
    </nav>
  </footer>

  <script>
    fetch('http://127.0.0.1:5000/products')
      .then(res => res.json())
      .then(products => {
        const grid = document.getElementById('productGrid');
        products.forEach(p => {
          const card = document.createElement('div');
          card.className = 'product-card-admin';
          card.innerHTML = `
            <img src="images/${p.image}" alt="${p.name}">
            <h3>${p.name}</h3>
            <p><strong>ğŸ’° Narx:</strong> ${p.price.toLocaleString()} soâ€˜m</p>
            <p><strong>ğŸ¯ Chegirma:</strong> ${p.discount}%</p>
            <p><strong>ğŸ“ Razmer:</strong> ${p.sizes?.join(', ') || '-'}</p>
            <p><strong>ğŸ“ Toifa:</strong> ${p.type}</p>
            <p><strong>ğŸ“¦ Qolgan:</strong> ${p.stock} dona</p>
            <p><strong>ğŸ“Š Sotilgan:</strong> ${p.sold} dona</p>
            <div class="admin-actions">
              <a href="admin-edit.html?id=${p.id}" class="edit-btn">âœï¸ Tahrirlash</a>
              <button class="delete-btn" onclick="deleteProduct(${p.id})">âŒ Oâ€˜chirish</button>
            </div>
          `;
          grid.appendChild(card);
        });
      });

    function deleteProduct(id) {
      if (!confirm("Mahsulotni oâ€˜chirishga ishonchingiz komilmi?")) return;
      fetch(`http://127.0.0.1:5000/products/delete/${id}`, {
        method: 'DELETE'
      })
      .then(res => res.json())
      .then(data => {
        alert("âœ… Mahsulot oâ€˜chirildi!");
        location.reload();
      })
      .catch(err => {
        alert("âŒ Oâ€˜chirishda xatolik: " + err);
      });
    }
  </script>

</body>
</html>